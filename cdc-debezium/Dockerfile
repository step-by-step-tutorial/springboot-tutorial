FROM eclipse-temurin:21-jdk-alpine

ARG JAR_PATH=./target
ARG JAR_NAME=cdc-debezium
ARG JAR_VERSION=0.0.1-SNAPSHOT
ARG TARGET_PATH=/app
ENV APPLICATION=${TARGET_PATH}/application.jar
ENV APP_HOST=0.0.0.0
ENV APP_PORT=8080
ENV APP_PROFILES=mysql,redis,kafka,debezium
ENV DATABASE_USERNAME=user
ENV DATABASE_PASSWORD=password
ENV DATABASE_HOST=mysql
ENV DATABASE_PORT=3306
ENV DATABASE_NAME=test_db
ENV REDIS_HOST=redis
ENV REDIS_PORT=6379
ENV KAFKA_TOPIC_NAME=cdc.test_db.example_table
ENV KAFKA_GROUP_ID=cdc.test_db.main-group
ENV KAFKA_URL=kafka:9093
ENV DEBEZIUM_URL=http://debezium:8083
ENV DEBEZIUM_REGISTER_PATH=/connectors
ENV DEBEZIUM_CONNECTORS_FILE=connectors.json
ENV TOPIC_PREFIX=cdc
ENV TABLES=test_db.example_table

ADD ${JAR_PATH}/${JAR_NAME}-${JAR_VERSION}.jar ${TARGET_PATH}/application.jar

EXPOSE ${APP_PORT}
ENTRYPOINT java -jar ${APPLICATION}